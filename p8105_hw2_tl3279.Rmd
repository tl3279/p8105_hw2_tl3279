---
title: "p8105_hw2_tl3279"
author: "Tianqi Li"
date: "2024-09-30"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1
We loaded the dataset, selected the variables, and changed the entry variable from characters to logical. 1,868 rows Ã— 20 columns.
```{r}
NYCsub = read_csv(
  "data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) |>
  janitor::clean_names() |>
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, ada
    ) |>
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

```{r}
NYCsub |> 
  select(station_name, line) |> 
  distinct()
```
465 unique stations.

```{r}
NYCsub |> 
  filter(ada == TRUE) |> 
  select(station_name, line) |> 
  distinct()
```
84 are ASA compliant.

```{r}
NYCsub |> 
  filter(vending == "NO") |> 
  pull(entry) |> 
  mean()
```
37.7% of station entrances/exits without vending allow entrance.

```{r}
station_A = 
  NYCsub |> 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") |> 
  filter(route == "A") |> 
  select(station_name, line) |> 
  distinct()
station_A
```
60 distinct stations serve the A train

```{r}
station_A_ADA = 
  NYCsub |> 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") |> 
  filter(route == "A", ada == TRUE) |> 
  select(station_name, line) |> 
  distinct()
station_A_ADA
```
Of the stations that serve the A train 17 stations are ASA compliant.

## Problem 2

import the Mr. Trash Wheel dataset. Drop the figure, select only columns with 
data entrances. Omit rows without dumpster-specific data. Round sports balls 
to integers. Add a name to identify that this is Mr. Trash Wheel. Change the 
variable type for year so it matches with the other two datasets.
```{r message = FALSE}
Mr_TW = read_excel(
  "data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Mr. Trash Wheel",
  skip = 1
) |>
  janitor::clean_names() |>
  select(1:14) |>
  filter(!is.na(dumpster)) |>
  mutate(sports_balls = as.integer(round(sports_balls))) |>
  mutate(trash_wheel = "Mr. Trash Wheel") |>
  mutate(year = as.numeric(year))
```

Do the same things with Professor Trash Wheel and Gwynnda.
```{r}
Prof_TW = read_excel(
  "data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Professor Trash Wheel",
  skip = 1) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(trash_wheel = "Professor Trash Wheel")

Gw_TW = read_excel(
  "data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Gwynnda Trash Wheel",
  skip = 1) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(trash_wheel = "Gwynnda Trash Wheel")
```

Bind the datasets
```{r}
TW_tidy = 
  bind_rows(Mr_TW, Prof_TW, Gw_TW) |>
  janitor::clean_names()
TW_tidy
cat("The combined dataset contains", nrow(TW_tidy), "observations.")
```
1033 observations in the resulting dataset. Key variables include dumpster, 
year, weight_tons, and so on. 

Calculate the total weight of trash collected by Professor Trash Wheel.
```{r}
TW_tidy |>
  filter(trash_wheel == "Professor Trash Wheel") |>
  summarize(total_weight = sum(weight_tons, na.rm = TRUE))
```
Professor Trash Wheel collected a total of 246.74 tons of trash

Calculate the total number of cigarette butts collected by Gwynnda in June of 2022.

```{r}
TW_tidy |>
  filter(trash_wheel == "Gwynnda Trash Wheel", month == "June", year == 2022) |>
  summarize(total_cig = sum(cigarette_butts, na.rm = TRUE))
```
In June 2022, Gwynnda Trash Wheel collected 18120 cigarette butts.
